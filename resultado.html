<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resultado do Teste Emocional</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="bg-green-50 text-gray-800 font-sans">

  <main class="max-w-4xl mx-auto py-16 px-6">
    <h1 class="text-3xl font-bold text-green-700 mb-8 text-center">üßæ Seu Resultado</h1>
    
    <div id="resultado" class="bg-white p-8 rounded-lg shadow-lg text-lg leading-relaxed"></div>

    <div id="contatos-apoio" class="bg-yellow-100 border-l-4 border-yellow-400 text-yellow-800 p-6 mt-8 rounded hidden max-w-3xl mx-auto">
      <!-- Ser√° preenchido dinamicamente -->
    </div>

    <div class="mt-10 text-center space-x-4">
      <a href="index.html" class="inline-block bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition">
        ‚Üê Voltar ao In√≠cio
      </a>
      <button id="btn-pdf" class="inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
        üìÑ Baixar Resultado em PDF
      </button>
    </div>
  </main>

  <script>
    (function() {
      const { jsPDF } = window.jspdf;

      function gerarTextoResultado(pontuacao) {
        let titulo = '';
        let descricao = '';
        let dicas = '';
        let mostrarContatos = false;

        if (pontuacao <= 10) {
          titulo = '‚úÖ Sa√∫de emocional em bom estado';
          descricao = `Seu teste indica que sua sa√∫de emocional est√° em um n√≠vel saud√°vel. 
          Continue cuidando do seu bem-estar com h√°bitos positivos, como manter uma rotina equilibrada, dormir bem e reservar tempo para atividades que gosta.`;
          dicas = `
          ‚Ä¢ Mantenha uma rotina regular de sono.  
          ‚Ä¢ Pratique atividades f√≠sicas regularmente.  
          ‚Ä¢ Converse com amigos e familiares sobre seus sentimentos.  
          ‚Ä¢ Estabele√ßa metas realistas para os estudos.  
          ‚Ä¢ Tire momentos para lazer e descanso.
          `;
          mostrarContatos = false;
        } else if (pontuacao <= 20) {
          titulo = '‚ö†Ô∏è Aten√ß√£o: sinais de estresse moderado';
          descricao = `Seu teste aponta que voc√™ pode estar enfrentando algum n√≠vel de estresse emocional.  
          Isso √© comum em per√≠odos de muita press√£o, mas √© importante observar esses sinais para evitar que se agravem.`;
          dicas = `
          ‚Ä¢ Procure organizar seu tempo para evitar ac√∫mulo de tarefas.  
          ‚Ä¢ Pratique t√©cnicas de respira√ß√£o e relaxamento.  
          ‚Ä¢ Converse com algu√©m de confian√ßa, como um professor ou amigo.  
          ‚Ä¢ Reserve momentos para hobbies e pausas durante o estudo.  
          ‚Ä¢ Considere buscar ajuda profissional, se necess√°rio.
          `;
          mostrarContatos = true;
        } else {
          titulo = 'üö® Alta sobrecarga emocional';
          descricao = `Seu resultado indica que voc√™ pode estar passando por um momento de alta sobrecarga emocional.  
          √â muito importante que voc√™ procure ajuda profissional, como psic√≥logos ou orientadores da escola, para receber o suporte adequado.`;
          dicas = `
          ‚Ä¢ Fale com um profissional de sa√∫de mental.  
          ‚Ä¢ N√£o hesite em procurar apoio na escola ou com familiares.  
          ‚Ä¢ Pratique atividades que aliviem a ansiedade, como caminhadas e medita√ß√£o.  
          ‚Ä¢ Evite o isolamento social e compartilhe seus sentimentos.  
          ‚Ä¢ Lembre-se: pedir ajuda √© um sinal de coragem e cuidado consigo mesmo.
          `;
          mostrarContatos = true;
        }

        return { titulo, descricao, dicas, mostrarContatos };
      }

      function montarHTML(pontuacao) {
        const { titulo, descricao, dicas, mostrarContatos } = gerarTextoResultado(pontuacao);
        let html = `
          <h2 class="text-2xl font-semibold text-center mb-4 text-green-700">${titulo}</h2>
          <p class="mb-6">${descricao}</p>
          <h3 class="text-xl font-semibold mb-2">Sugest√µes para voc√™:</h3>
          <pre class="whitespace-pre-line bg-green-100 p-4 rounded">${dicas.trim()}</pre>
          <p class="mt-6 text-sm text-gray-600 text-center">
            Este teste √© apenas um indicativo e n√£o substitui avalia√ß√£o profissional.
          </p>
        `;

        if (mostrarContatos) {
          html += `
            <div class="mt-8 bg-yellow-100 border-l-4 border-yellow-400 text-yellow-800 p-6 rounded">
              <h3 class="text-lg font-semibold mb-2">üìû Precisa de ajuda? Veja os contatos de apoio emocional:</h3>
              <ul class="list-disc list-inside space-y-1">
                <li><strong>CVV (Centro de Valoriza√ß√£o da Vida):</strong> 188 - Liga√ß√£o gratuita e an√¥nima</li>
                <li><strong>SAMU (Emerg√™ncia):</strong> 192</li>
                <li><a href="apoio.html" class="text-yellow-700 underline font-semibold">Clique aqui para acessar mais contatos de apoio</a></li>
              </ul>
            </div>
          `;
        }

        return html;
      }

      function calcularPontuacao() {
        const params = new URLSearchParams(window.location.search);
        let pontuacao = 0;

        for (let i = 1; i <= 15; i++) {
          const resposta = params.get('q' + i);
          if (resposta === 'sim') pontuacao += 2;
          else if (resposta === 'as_vezes') pontuacao += 1;
        }

        return pontuacao;
      }

      function gerarPDF(titulo, descricao, dicas) {
        const doc = new jsPDF();
        doc.setFontSize(18);
        doc.text('Resultado do Teste Emocional', 14, 22);
        doc.setFontSize(14);
        doc.text(titulo, 14, 40);
        
        let y = 50;
        const descricaoLines = doc.splitTextToSize(descricao, 180);
        doc.text(descricaoLines, 14, y);
        y += descricaoLines.length * 8 + 10;
        
        doc.setFontSize(16);
        doc.text('Sugest√µes para voc√™:', 14, y);
        y += 10;
        
        doc.setFontSize(12);
        const dicasLines = doc.splitTextToSize(dicas.trim(), 180);
        doc.text(dicasLines, 14, y);
        
        doc.save('resultado_teste_emocional.pdf');
      }

      // Execu√ß√£o principal
      const pontuacao = calcularPontuacao();
      const { titulo, descricao, dicas, mostrarContatos } = gerarTextoResultado(pontuacao);

      document.getElementById('resultado').innerHTML = montarHTML(pontuacao);

      if (mostrarContatos) {
        document.getElementById('contatos-apoio').classList.remove('hidden');
        document.getElementById('contatos-apoio').innerHTML = `
          <h3 class="text-lg font-semibold mb-2 text-yellow-800">üìû Contatos de Apoio Emocional</h3>
          <ul class="list-disc list-inside space-y-1 text-yellow-800">
            <li><strong>CVV (Centro de Valoriza√ß√£o da Vida):</strong> 188 - Liga√ß√£o gratuita e an√¥nima</li>
            <li><strong>SAMU (Emerg√™ncia):</strong> 192</li>
            <li><a href="apoio.html" class="underline font-semibold">Clique aqui para acessar a lista completa de contatos</a></li>
          </ul>
        `;
      }

      document.getElementById('btn-pdf').addEventListener('click', () => {
        gerarPDF(titulo, descricao, dicas);
      });
    })();
  </script>

</body>
</html>
